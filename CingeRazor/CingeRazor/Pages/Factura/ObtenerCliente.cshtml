@page
@model ObtenerClienteModel
@{
    ViewBag.Title = "Buscar clientes";
    Layout = null;
}

<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" />
<link rel="stylesheet" href="~/css/site.css" />
<script src="~/lib/jquery-3.3.1.min.js"></script>
<script>

    function seleccionar(codigo) {
        var Cliente = {};
        Cliente.Codigo = codigo;
        console.info(codigo);
        window.opener.obtenerCliente(Cliente);
        window.close();
    }
</script>
<div>
    <button class='btn btn-danger' type='button' onclick="window.close()">
        <span class='fa fa-remove'></span>
        Regresar
    </button>
</div>
<h2>Filtros</h2>
<div class="row">
    <div class="col-md-4">
        <form sp-page="./ObtenerCliente" method="get">
            <div class="form-group">
                <label class="control-label">Código: </label>
                <input type="text" name="CodigoBusqueda" value="@Model.CodigoBusqueda" class="form-control" />
            </div>
            <div class="form-group">
                <label class="control-label">Nombre: </label>
                <input type="text" name="NombreBusqueda" value="@Model.NombreBusqueda" class="form-control" />
            </div>
            <div class="form-group">
                <label class="control-label">Cédula: </label>
                <input type="text" name="CedulaBusqueda" value="@Model.CedulaBusqueda" class="form-control" />
            </div>
            <div class="form-group">
                <label class="control-label">Teléfono: </label>
                <input type="text" name="TelefonoBusqueda" value="@Model.TelefonoBusqueda" class="form-control" />
            </div>
            <input type="submit" value="Search" class="btn btn-default" /> |
            <a asp-page="./ObtenerCliente">Todos los clientes</a>
        </form>
    </div>
</div>
<table class="table" id="tbcliente">
    <thead>
        <tr>
            <th>
                <a asp-page="./ObtenerCliente" asp-route-ordenSort="@Model.CodigoSort">
                    @Html.DisplayNameFor(model => model.Clientes[0].Código)
                </a>
            </th>
            <th>
                <a asp-page="./ObtenerCliente" asp-route-ordenSort="@Model.NombreSort">
                    @Html.DisplayNameFor(model => model.Clientes[0].Nombre)
                </a>
            </th>
            <th>
                <a asp-page="./ObtenerCliente" asp-route-ordenSort="@Model.TelefonoSort">
                    @Html.DisplayNameFor(model => model.Clientes[0].Teléfono)
                </a>
            </th>
            <th>
                <a asp-page="./ObtenerCliente" asp-route-ordenSort="@Model.CedulaSort">
                    @Html.DisplayNameFor(model => model.Clientes[0].Cédula)
                </a>
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.Clientes)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Código)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Nombre)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Teléfono)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Cédula)
                </td>
                <td>
                    <button class='btn btn-success' type='button' onclick="seleccionar('@Html.DisplayFor(modelItem => item.Código)')"><span class='fa fa-remove'></span>
                        Seleccionar
                    </button>
                </td>
            </tr>
        }
    </tbody>
</table>


@{
    var prevDisabled = !Model.Clientes.HasPreviousPage ? "disabled" : "";
    var nextDisabled = !Model.Clientes.HasNextPage ? "disabled" : "";
}

<a asp-page="./ObtenerCliente"
   asp-route-sortOrder="@Model.ActualSort"
   asp-route-pageIndex="@(Model.Clientes.PageIndex - 1)"
   asp-route-codigoActual="@Model.CodigoBusqueda"
   asp-route-nombreActual="@Model.NombreBusqueda"
   asp-route-cedulaActual="@Model.CedulaBusqueda"
   asp-route-telefonoActual="@Model.TelefonoBusqueda"
   class="btn btn-default @prevDisabled">
    Previous
</a>
<a asp-page="./ObtenerCliente"
   asp-route-sortOrder="@Model.ActualSort"
   asp-route-pageIndex="@(Model.Clientes.PageIndex + 1)"
   asp-route-codigoActual="@Model.CodigoBusqueda"
   asp-route-nombreActual="@Model.NombreBusqueda"
   asp-route-cedulaActual="@Model.CedulaBusqueda"
   asp-route-telefonoActual="@Model.TelefonoBusqueda"
   class="btn btn-default @nextDisabled">
    Next
</a>

